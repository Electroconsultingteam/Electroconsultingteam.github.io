<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Radovi | ELECTRO CONSULTING TEAM d.o.o.</title>
  <meta name="description" content="Reference i primjeri izvedenih radova - ELECTRO CONSULTING TEAM d.o.o." />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
<header class="header">
  <div class="container header-inner">
    <a class="brand" href="index.html#top" aria-label="Naslovna">
      <div class="logo-badge">
        <img src="assets/logo_ect.png" alt="ELECTRO CONSULTING TEAM d.o.o. logo" />
      </div>
      <div class="brand-text">
        <div class="brand-title">ELECTRO CONSULTING TEAM d.o.o.</div>
        <div class="brand-sub">Dostupno na području cijele Hrvatske</div>
      </div>
    </a>

    <nav class="nav" aria-label="Glavni izbornik">
      <a class="nav-link" href="index.html#top">Naslovna</a>
      <a class="nav-link" href="index.html#usluge">Usluge</a>
      <a class="nav-link active" href="radovi.html">Radovi</a>
      <a class="nav-link" href="index.html#kontakt">Kontakt</a>
    </nav>

    <div class="search">
      <input id="searchInput" type="search" placeholder="Pretraži radove…" aria-label="Pretraži radove" />
      <button id="searchBtn" class="btn btn-small" type="button">Traži</button>
    </div>
  </div>
</header>

<main>
  <section class="section">
    <div class="container">
      <h2>Radovi</h2>
      <p class="muted">Primjeri izvedenih projekata.</p>

      <div class="gallery">
        <figure class="card">
          <img class="gallery-img" src="assets/radovi/kuhinja-rasvjeta-01.jpg" alt="Elektro instalacije i rasvjeta - interijer" />
          <figcaption class="muted small">Rasvjeta i instalacije (interijer)</figcaption>
        </figure>
      </div>

      <div id="searchStatus" class="muted small" aria-live="polite"></div>
    </div>
  </section>
</main>

<footer class="footer">
  <div class="container footer-inner">
    <div>
      <strong>ELECTRO CONSULTING TEAM d.o.o.</strong><br />
      Ulica bana Josipa Jelačića 166, 31220 Višnjevac
    </div>
    <div class="muted small">
      © <span id="y"></span> ELECTRO CONSULTING TEAM d.o.o.
    </div>
  </div>
</footer>

<script>
  document.getElementById("y").textContent = new Date().getFullYear();

  // tražilica na stranici Radovi
  const input = document.getElementById("searchInput");
  const btn = document.getElementById("searchBtn");
  const status = document.getElementById("searchStatus");
  const scope = document.querySelector("main");

  function clearMarks(){
    scope.querySelectorAll("mark.search-hit").forEach(m => {
      const text = document.createTextNode(m.textContent);
      m.replaceWith(text);
    });
    scope.normalize();
  }

  function markAll(query){
    clearMarks();
    if (!query) { status.textContent = ""; return []; }

    const walker = document.createTreeWalker(scope, NodeFilter.SHOW_TEXT, {
      acceptNode: (node) => {
        if (!node.nodeValue || !node.nodeValue.trim()) return NodeFilter.FILTER_REJECT;
        const p = node.parentElement;
        if (!p) return NodeFilter.FILTER_REJECT;
        if (["SCRIPT","STYLE","NOSCRIPT","IFRAME","SELECT","OPTION","TEXTAREA","INPUT"].includes(p.tagName)) return NodeFilter.FILTER_REJECT;
        return NodeFilter.FILTER_ACCEPT;
      }
    });

    const hits = [];
    const q = query.toLowerCase();

    while (walker.nextNode()){
      const node = walker.currentNode;
      const text = node.nodeValue;
      const idx = text.toLowerCase().indexOf(q);
      if (idx === -1) continue;

      const before = document.createTextNode(text.slice(0, idx));
      const match = document.createElement("mark");
      match.className = "search-hit";
      match.textContent = text.slice(idx, idx + query.length);
      const after = document.createTextNode(text.slice(idx + query.length));

      const frag = document.createDocumentFragment();
      frag.appendChild(before);
      frag.appendChild(match);
      frag.appendChild(after);

      node.parentNode.replaceChild(frag, node);
      hits.push(match);
    }
    return hits;
  }

  function doSearch(){
    const q = input.value.trim();
    const hits = markAll(q);
    if (!q){ status.textContent = ""; return; }
    if (hits.length === 0){ status.textContent = `Nema rezultata za: "${q}".`; return; }
    status.textContent = `Pronađeno: ${hits.length} (prikaz prvog).`;
    hits[0].scrollIntoView({ behavior:"smooth", block:"center" });
  }

  btn.addEventListener("click", doSearch);
  input.addEventListener("keydown", (e) => {
    if (e.key === "Enter") { e.preventDefault(); doSearch(); }
    if (e.key === "Escape") { input.value = ""; clearMarks(); status.textContent = ""; }
  });
</script>
</body>
</html>
